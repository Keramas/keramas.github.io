---
layout: post
title: 'TAMUCTF: Pwn 1 & 2'
date: '2018-02-25T18:44:00.000-08:00'
author: Keramas
tags:
- CTF challenge
modified_time: '2018-02-25T18:44:27.340-08:00'
thumbnail: https://4.bp.blogspot.com/-OBJyCCSeGXo/WpNyLJ47unI/AAAAAAAAAew/Zn_V1MU2YR0e0RLnQvg8bxGUXXVvUoRMgCEwYBhgL/s72-c/pwn1.png
blogger_id: tag:blogger.com,1999:blog-4206503528938574504.post-4971697284878804719
blogger_orig_url: https://k3ramas.blogspot.com/2018/02/tamuctf-pwn-1-2.html
---

Pwn1:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-OBJyCCSeGXo/WpNyLJ47unI/AAAAAAAAAew/Zn_V1MU2YR0e0RLnQvg8bxGUXXVvUoRMgCEwYBhgL/s1600/pwn1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="474" data-original-width="597" height="254" src="https://4.bp.blogspot.com/-OBJyCCSeGXo/WpNyLJ47unI/AAAAAAAAAew/Zn_V1MU2YR0e0RLnQvg8bxGUXXVvUoRMgCEwYBhgL/s320/pwn1.png" width="320" /></a></div>Disassembling the binary we are given, we can see there is a print_flag function that is preceded by a cmp instruction.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-3cO9xu3TEkQ/WpNyLr-jGqI/AAAAAAAAAe0/dXfvH_uxgvIRPv4HNot0kEgHWJzSXdlfQCEwYBhgL/s1600/pwn1disas.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="959" data-original-width="651" height="320" src="https://4.bp.blogspot.com/-3cO9xu3TEkQ/WpNyLr-jGqI/AAAAAAAAAe0/dXfvH_uxgvIRPv4HNot0kEgHWJzSXdlfQCEwYBhgL/s320/pwn1disas.png" width="217" /></a></div><br />We can perform a buffer overflow to manually enter the hex word "0xf007ba11" so that the comparison statement evaluates properly and the print_flag function is executed.<br /><br />Looking at the assembly we can determine that our padding for our exploit will be 23 bytes long + 4 more bytes with our hex word. Remember though--this needs to be put in little endian, so we end up with the following payload:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-5IAxIew6G80/WpNyMowWIjI/AAAAAAAAAfc/viWRbksOLDsIM8N8-RHQ2U1A7L84fPgQwCEwYBhgL/s1600/pwn1python.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="106" data-original-width="322" height="105" src="https://2.bp.blogspot.com/-5IAxIew6G80/WpNyMowWIjI/AAAAAAAAAfc/viWRbksOLDsIM8N8-RHQ2U1A7L84fPgQwCEwYBhgL/s320/pwn1python.png" width="320" /></a></div><br /><br />Testing this out in GDB we see that it works perfectly, and we are able to fulfill the check.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-Dba3izUB2uU/WpNyKr13vvI/AAAAAAAAAfg/lUgAkdBEiZ8axFjswXqn7CKCvCbc15qJwCEwYBhgL/s1600/gdbpwn1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="345" data-original-width="846" height="130" src="https://3.bp.blogspot.com/-Dba3izUB2uU/WpNyKr13vvI/AAAAAAAAAfg/lUgAkdBEiZ8axFjswXqn7CKCvCbc15qJwCEwYBhgL/s320/gdbpwn1.png" width="320" /></a></div><br /><br />Now we can take our payload and send it to the server running the binary.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-t3PWOnA9RvM/WpNyMYIanRI/AAAAAAAAAfU/lY3ayXfZ9kAa8pDn4x4c6lznZL7L3C0PQCEwYBhgL/s1600/pwn1flag.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="131" data-original-width="636" height="65" src="https://2.bp.blogspot.com/-t3PWOnA9RvM/WpNyMYIanRI/AAAAAAAAAfU/lY3ayXfZ9kAa8pDn4x4c6lznZL7L3C0PQCEwYBhgL/s320/pwn1flag.png" width="320" /></a></div><br />And we get the flag!<br /><br /><br />=============<br /><br />Pwn 2:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-zp-Oz3MVA9M/WpNyNN2k5YI/AAAAAAAAAfU/lZ9cN0rOdDoff0Dqfn_py4PSKwIham__QCEwYBhgL/s1600/pwn2challenge.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="404" data-original-width="599" height="215" src="https://1.bp.blogspot.com/-zp-Oz3MVA9M/WpNyNN2k5YI/AAAAAAAAAfU/lZ9cN0rOdDoff0Dqfn_py4PSKwIham__QCEwYBhgL/s320/pwn2challenge.png" width="320" /></a></div><br />Using objectdump first, we are able to see that this is a hidden print_flag function that we can call after initiating a buffer overflow.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-xEO6kQPnuWs/WpNyOG8HWHI/AAAAAAAAAfc/TOguGGTTuu0H8_Dbn6WAjoL2w6T6MfpiACEwYBhgL/s1600/pwn2printflaghex.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="205" data-original-width="678" height="192" src="https://3.bp.blogspot.com/-xEO6kQPnuWs/WpNyOG8HWHI/AAAAAAAAAfc/TOguGGTTuu0H8_Dbn6WAjoL2w6T6MfpiACEwYBhgL/s640/pwn2printflaghex.png" width="640" /></a></div><br /><br />This time our buffer is a bit larger than last time, and our padding will be 243 bytes followed by our 4 byte address for print_flag.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-LI0pf9IOPOI/WpNyOgtmvtI/AAAAAAAAAfg/aTL3m9KRkTwpllkaQqKAecjDFeeP1d5BgCEwYBhgL/s1600/pwn2python.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="69" data-original-width="302" src="https://1.bp.blogspot.com/-LI0pf9IOPOI/WpNyOgtmvtI/AAAAAAAAAfg/aTL3m9KRkTwpllkaQqKAecjDFeeP1d5BgCEwYBhgL/s1600/pwn2python.png" /></a></div><br />Sending this to the server, we are able to get the flag!<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-ok986tZ55Wg/WpNyNrno6mI/AAAAAAAAAfY/-ud1mx-DSzgUKmQ-CYzKDZZgpNyN_E9XgCEwYBhgL/s1600/pwn2flag.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="164" data-original-width="907" height="57" src="https://2.bp.blogspot.com/-ok986tZ55Wg/WpNyNrno6mI/AAAAAAAAAfY/-ud1mx-DSzgUKmQ-CYzKDZZgpNyN_E9XgCEwYBhgL/s320/pwn2flag.png" width="320" /></a></div><br /><br />