---
layout: post
title: 34C3 Junior CTF
date: '2017-12-29T16:56:00.000-08:00'
author: Keramas
tags:
- CTF challenge
modified_time: '2017-12-31T14:42:21.767-08:00'
blogger_id: tag:blogger.com,1999:blog-4206503528938574504.post-4636946887218826730
blogger_orig_url: https://k3ramas.blogspot.com/2017/12/34c3-junior-ctf.html
---

<b>CTF</b>: 34C3 Junior CTF 2017<br /><br /><b>Challenge</b>:<br />SPI<br /><br /><b>Category</b>:<br />Misc<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/SPI_Challenge.png?raw=true" /><br /><br />We are given a sound file to listen to, which is a recording of various values.<br />Writing them all down gives us the following:<br /><br />76 83 48 116 76 105 52 103<br />76 83 48 116 76 83 52 103<br />76 105 48 117 76 83 65 116<br />76 83 48 116 76 105 65 116<br />76 105 48 117 76 83 52 103<br />76 83 48 116 76 83 48 103<br />76 83 52 117 76 83 65 117<br />76 83 52 117 73 67 48 117<br />76 83 52 116 76 105 65 116<br />76 83 48 117 73 67 48 116<br />76 83 48 116 73 67 48 117<br />76 83 52 116 76 105 65 116<br />76 83 48 116 76 83 65 116<br />76 105 52 116 73 67 52 116<br />76 105 52 78 67 103 61 61<br /><br />These are decimal values, so converting to ascii we are given a base64 encoding:<br /><br />LS0tLi4gLS0tLS4gLi0uLSAtLS0tLiAtLi0uLS4gLS0tLS0gLS4uLSAuLS4uIC0uLS4tLiAtLS0uIC0tLS0tIC0uLS4tLiAtLS0tLSAtLi4tIC4tLi4NCg==<br /><br />Converting the base64 back to ascii gives us some morse code:<br /><br />---.. ----. .-.- ----. -.-.-. ----- -..- .-.. -.-.-. ---. ----- -.-.-. ----- -..- .-..<br /><br />I spent a bit trying to decipher this because it is not just a simple case of decoding it as is. I even reversed the whole code, but that didn't work either, but then I decided to swap all the dashes for dots and all the dots for dashes and got the flag!<br /><br />...-- ....- -.-. ....- .-.-.- ..... .--. -.-- .-.-.- ...- ..... .-.-.- ..... .--. -.--<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br /><br />Flag:<br /><span style="white-space: pre;"> </span><br />34C4.5PY.V5.5PY<br /><br /><br />===================================<br /><br /><b>Challenge</b>:<br />Digital Billboard<br /><br /><b>Category</b>:<br />PWN<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/billboard_challenge.png?raw=true" /><br /><br />This program allows us to set text displayed on a billboard, but when exploring the menu options there is a devmode that is locked to the regular user.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/billboard.png?raw=true" /><br /><br />Exploring the source code that they give us, this devmode allows us to execute the priviledged function "shell" which gives us access to /bin/bash--so this is our goal here.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/billboard_code.png?raw=true" /><br /><br />Luckily there is an easy way to enable devmode. The set_text function is using the strcpy function, which we can exploit.<br />The struct for billboard has an array for text with a buffer of 256 bytes, which is immediately followed by the flag for devmode. We can overflow this buffer to change the subsequent value and enable devmode.<br /><br />Inputting our string we are able to access devmode and use the shell command which gives us an interactive bash shell.<br />Checking the files in the directory, we find the flag!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/billboard2.png?raw=true" /><br /><br /><br />===================================<br /><br /><b>Challenge</b>:<br />Babybash<br /><br /><b>Category</b>:<br />Misc<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/babybash_Challenge.png?raw=true" /><br /><br />For this challenge we are dropped into a restricted bash shell, but we need to execute the "get_flag" program.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/babybashshell.png?raw=true" /><br /><br />Luckily we are able to use capital letters and creativity to bypass this.<br /><br />They throw a bit of a twist into the mix when executing the program for the first time, and it requires an additional argument,so we modify our command a bit and get the flag upon properly execution.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/babybash_answer.png?raw=true" /><br /><br />===================================<br /><br /><b>Challenge</b>:<br />ARM1<br /><br /><b>Category</b>:<br />Rev<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/arm1_challenge.png?raw=true" /><br /><br />Simply running strings on the ARM binary will reveal the flag (the other ARM-related challenges were not this simple...)<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/arm1_flag.png?raw=true" /><br /><br />===================================<br /><br /><b>Challenge</b>:<br />ARM2<br /><br /><b>Category</b>:<br />Rev<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/arm2challenge.png?raw=true" /><br /><br />Upgrading the difficulty from the prior ARM challenge, it seems like the flag is encrypted in some way judging by the characters that follow the "The flag is:" string.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/encryptedflag.png?raw=true" /><br /><br />I used a couple of programs to analyze. I used IDA to grab all the hex values for the encrypted string.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/xoredvalue.png?raw=true" /><br /><br />And since I couldn't get a good output of the pseudocode for whatever reason, I used Hopper, which gave me the hint that these values were being xor'ed with 0x55.<br /><br />Using <a href="https://github.com/Keramas/Hexxorscii">a script that I wrote</a> to automate the decryption of these types of challenges (seems like there are often similar ones in CTFs all the time), we are able to get our flag!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/34C3-CTF/arm2flag.png?raw=true" /><br /><br />