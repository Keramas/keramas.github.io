---
layout: post
title: TUCTF 2017 | Web Challenges
date: '2017-11-26T16:21:00.002-08:00'
author: Keramas
tags:
- CTF challenge
modified_time: '2017-11-26T16:21:42.496-08:00'
blogger_id: tag:blogger.com,1999:blog-4206503528938574504.post-5200531498306878616
blogger_orig_url: https://k3ramas.blogspot.com/2017/11/tuctf-2017-web-challenges.html
---

<b>Challenge:</b><br />High Source<br /><b>Category:</b><br />Web<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/tuctf_highsource_challenge.png?raw=true" /><br /><br />Accessing the web page and immediately looking at the source we get trolled. Nothing here... But what about in the login.js source?<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/highsource_sourcecode.png?raw=true" /><br /><br />Oh hey, a password! Using this to login we then get our flag!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/highsource_loginJS.png?raw=true" /><br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/highsource_flag.png?raw=true" /><br /><br /><br /><b>Challenge:</b><br />Cookie Duty<br /><b>Category:</b><br />Web<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/cookieduty_challenge.png?raw=true" /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/cookieduty_homepage.png?raw=true" /><br /><br />The first page we land on gives a good hint as to what this will entail with cookies... We aren't admin, but can we become an admin by modifying the cookie? "not_admin" is set to a 1 flag, so if we modify this to a 0 we should be able to become admin.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/cookieduty_application.png?raw=true" /><br /><br />Changing the cookie and making a GET request with Burp Suite, we trick it to thinking we are admin and get our flag!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/cookieduty_flag.png?raw=true" /><br /><br /><br /><b>Challenge:</b><br />Git Gud<br /><b>Category:</b><br />Web<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/gitgud_challenge.png?raw=true" /><br /><br />Based on the challenge description we know that the site is using Version Control Systems and the title also gives it away that we are looking for something git-related. After researching some stuff about this, it's possible to access a directory at /.git which gives all of the history info, objects, what have you.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/gitgudgitdirectory.png?raw=true" /><br /><br />To make this a bit easier, I just downloaded everything and used comannd line to traverse through the directories. In the master file you can see an update entry for adding a flag, and using the data on the left we can cat the info until we are able to see the past entry and get our flag!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/gitgud_gitupdated.png?raw=true" /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/gitgud-getflag.png?raw=true" /><br /><br /><br /><br /><b>Challenge:</b><br />Cookie Harrelson<br /><b>Category:</b><br />Web<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/cookieharrelson_hompage.png?raw=true" /><br /><br />More cookies! Inspecting the response/request headers upon loading, we can see that there is a cookie being passed.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/cookieharrelson_startcookie.png?raw=true" /><br /><br />This coded in base64, and decoding it we get:<br />cat index.txt<br /><br />Neat... so what if we just encode something like 'cat flag.txt' in base64 and swap it in? Well, this is what I did, but it wasn't as easy as that. Unfortunately when subbing in something different, the cookie gets modified and it becomes something like this:<br /><br />cat index.txt #(new command here)<br /><br />So we are getting filtered and need to bypass it somehow! After a lot of experimentation/trial and error, the trick here is to get a carriage return. Using Burp to decode the original cookie, modify it, and then re-encode it, we get our new cookie.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/cookies_flagencoded.png?raw=true" /><br /><br />Now we can put this in the repeater and make our GET request, which gives us the flag!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/cookies_getflag.png?raw=true" /><br /><br /><br /><br /><b>Challenge:</b><br />iFrame and Shame<br /><b>Category:</b><br />Web<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/iframe_challenge.png?raw=true" /><br /><br />This challenge took a bit of trial and error to solve. I started by checking for input validation in the search box by adding an " and that seemed to break the format a bit, which kind of tipped me off there may be a possibility for code injection.<br /><br />After trying different things for a while, the following command worked as a test:<br />"; echo $(ls) #<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/iframebroke!.png?raw=true" /><br /><br />Based on this, we just change our command to give us our flag:<br />"; echo $(cat flag) #<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/iframe_flagget.png?raw=true" /><br /><br />