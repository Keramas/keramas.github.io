---
layout: post
title: RC3 CTF 2017
date: '2017-11-19T22:46:00.000-08:00'
author: Keramas
tags:
- CTF challenge
modified_time: '2017-11-20T20:06:39.939-08:00'
blogger_id: tag:blogger.com,1999:blog-4206503528938574504.post-2181264698073522176
blogger_orig_url: https://k3ramas.blogspot.com/2017/11/rc3-ctf-2017.html
---

<b>CTF:</b><br />RC3 CTF 2017<br /><br /><b>Challenge</b><br />Easy Peasy<br /><br /><b>Type</b><br />Pwn<br /><br />For this challenge we get a binary to download as well as a remote address/port that is running the same program. Upon connecting we are prompted for a key:<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/easypeasytest.png?raw=true" /><br /><br />After testing this out, I pulled up Hopper to analyze the binary.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/easypeasy_hopper2.png?raw=true" /><br /><br />We can immediately see some interesting hex in our assembly, so checking how it's constructed with C we can see the following:<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/easy_peasy_hopper.png?raw=true" /><br /><br />It seems that all we need to do is make sure that these two hex "phrases" make it onto the stack at the right place, and then we will be given our flag. However, we the key is to land these exactly where the variables need to be for the check to take place.<br /><br />If we look at the assembly and the code generated by Hopper, we can see that the stack is going to start 24 bytes in (0x18). Furthermore, looking at the output from Hopper, we can see that var_4 (which is the 0xcafef00d address) is found at 4 bytes less than the start of the stack (20), and var_8 (the 0xc0ffee address) is found at 8 bytes less (16). We now how much to pad our exploit before we pass the two addresses to the program.<br /><br />With all this in mind we create the following exploit script with Python:<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/easypeasy_py.png?raw=true" /><br /><br />Running this we get our flag!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/easypeasy_flag.png?raw=true" /><br /><br /><br />============================================<br /><div><br /></div><br /><br /><b>Challenge:</b><br />"This is where I'd put my Home Page... IF I HAD ONE<br /><br /><b>Type:</b><br />Web<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/homepagechallenge_rc3.png?raw=true" /><br /><br />When we access the site, it starts redirecting to different URLs in succession very quickly, so I turned to curl to access the site instead of a browser. Doing so, we discover that there is a hidden character in what comes back, and chasing each URL it points to we can uncover a hidden message.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/thisiswherehomepage_r3c.png?raw=true" /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/thisiswherehomepage_r3c_2.png?raw=true" /><br /><br />Putting it all together we get our flag:<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/homepage_answer.png?raw=true" /><br /><br />============================================<br /><br /><b>Challenge:</b><br />English Class<br /><br /><b>Type:</b><br />Crypto<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/englishclass_rc3.png?raw=true" /><br /><br />Opening up the PDF we see the following:<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/English_Class_1.png?raw=true" /><br /><br />This just smells of a book cipher, but what book can we use? Well, looking at the first letter of each word in the table, we find that it spells out "GUTENBERGDICTIONARYBYVARIOUS". We can access this dictionary on the net, and then we can look up each word one by one, and then use the page numbers to correspond to the letter in the definition of the word. Doing this gives us our solution:<br /><br />"yoursolutionisfindingmeaning"<br /><br />And the flag ends up being "findingmeaning"<br /><br />=============================================<br /><br /><b>Challenge:</b><br />Science Class<br /><br /><b>Type:</b><br />Crypto<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/scienceclass_chall.png?raw=true" /><br /><br />Yet another PDF!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/Science_Class_200.png?raw=true" /><br /><br />The clue here is chemistry, and we are going to use the periodic table to decode this one.<br />Using the periodic table as a guide, we look up the corresponding elements where each color block is.<br /><br />We get:<br />Be S Ga Se Er<br /><br />Doesn't spell anything out directly, but if we organize them according to ROYGBIV (per the colors in the table) we get our flag:<br /><br />"beergases"<br /><br /><br />============================================<br /><br /><b>Challenge:</b><br />My Favorite Things<br /><br /><b>Type:</b><br />Reversing<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/myfavortiethings_rc3_challenge.png?raw=true" /><br /><br />Very simple challenge. Simply downloading the binary and running strings on it, and we find our flag!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/myfavoritethings_rc3.png?raw=true" /><br /><br /><br />============================================<br /><br /><br /><b>Challenge:</b><br />Catastrophe<br /><br /><b>Type:</b><br />Forensics<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/catastrophe_rc3_challenge.png?raw=true" /><br /><br />Downloading the pcap file we can follow the tcp stream and immediately see there is an image. We can rebuild this by looking at what objects we can export as HTTP.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/catastrophe_pcap.png?raw=true" /><br /><br />Opening up the image we get our flag!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/RC3CTF2017/catastrophe_flag.png?raw=true" /><br /><div><br /></div>