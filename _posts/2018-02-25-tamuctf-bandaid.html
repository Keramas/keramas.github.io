---
layout: post
title: 'TAMUCTF: Bandaid'
date: '2018-02-25T18:52:00.002-08:00'
author: Keramas
tags:
- CTF challenge
modified_time: '2018-02-25T18:52:33.736-08:00'
thumbnail: https://2.bp.blogspot.com/-HFhHso7Ccxc/WpNyI-LERyI/AAAAAAAAAfU/9Ua477f110w3ahvMVavYrPMKqR51sFw8QCEwYBhgL/s72-c/bandaid1.png
blogger_id: tag:blogger.com,1999:blog-4206503528938574504.post-4509151334065808208
blogger_orig_url: https://k3ramas.blogspot.com/2018/02/tamuctf-bandaid.html
---

We are given a broken binary that claims it needs some fixin'!<br /><br />We can go about this two ways: Patch the assembly so it executes as it should OR we can just force it to execute properly in GDB by setting the EIP to the function it is supposed to execute. I went with the latter method.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-HFhHso7Ccxc/WpNyI-LERyI/AAAAAAAAAfU/9Ua477f110w3ahvMVavYrPMKqR51sFw8QCEwYBhgL/s1600/bandaid1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="675" data-original-width="900" height="480" src="https://2.bp.blogspot.com/-HFhHso7Ccxc/WpNyI-LERyI/AAAAAAAAAfU/9Ua477f110w3ahvMVavYrPMKqR51sFw8QCEwYBhgL/s640/bandaid1.png" width="640" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-L1XQPY_ay28/WpNyI2ZdyQI/AAAAAAAAAfQ/q0BAE-amzow_UFQqH4ULDY1J9l-zbrVagCEwYBhgL/s1600/bandaid3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="514" data-original-width="913" height="360" src="https://1.bp.blogspot.com/-L1XQPY_ay28/WpNyI2ZdyQI/AAAAAAAAAfQ/q0BAE-amzow_UFQqH4ULDY1J9l-zbrVagCEwYBhgL/s640/bandaid3.png" width="640" /></a></div><br />Setting the EIP to the address for _Z2f2v, we continue the program and it spits out a ton of stuff.<br />The top portion is definitely some sort of encryption, and the two big chunks below it are a ton of base64. Wonder that that could be...<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-VDbw9CxR19U/WpNyJb80W-I/AAAAAAAAAfg/UcFQ4hjddhI80ptg1pELN6gcvyDmEYHCACEwYBhgL/s1600/bandaid4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="595" data-original-width="1078" height="352" src="https://3.bp.blogspot.com/-VDbw9CxR19U/WpNyJb80W-I/AAAAAAAAAfg/UcFQ4hjddhI80ptg1pELN6gcvyDmEYHCACEwYBhgL/s640/bandaid4.png" width="640" /></a></div><br />Ah--neat! So we get a private and public RSA key, which means the private key should be able to decrypt the message at the top.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-T9qt0BJXNec/WpNyJutIXzI/AAAAAAAAAfU/JMUkutAlOz8QeVfs-zwU8TWkLlr30NhHACEwYBhgL/s1600/bandaid5.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="272" data-original-width="670" height="258" src="https://1.bp.blogspot.com/-T9qt0BJXNec/WpNyJutIXzI/AAAAAAAAAfU/JMUkutAlOz8QeVfs-zwU8TWkLlr30NhHACEwYBhgL/s640/bandaid5.png" width="640" /></a></div><br />Modifying an existing RSA decryption python script, we can easily decrypt our message and get our flag!<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-BXsktFwS-Yk/WpNyKIVcRJI/AAAAAAAAAfc/vncaCKFcmgsqDEtq9kIvCn1xA2pvKukmwCEwYBhgL/s1600/bandaid6.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="40" data-original-width="480" height="32" src="https://2.bp.blogspot.com/-BXsktFwS-Yk/WpNyKIVcRJI/AAAAAAAAAfc/vncaCKFcmgsqDEtq9kIvCn1xA2pvKukmwCEwYBhgL/s400/bandaid6.png" width="400" /></a></div><br /><br />