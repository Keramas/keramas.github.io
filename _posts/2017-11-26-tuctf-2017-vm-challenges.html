---
layout: post
title: TUCTF 2017 | VM Challenges
date: '2017-11-26T16:19:00.000-08:00'
author: Keramas
tags:
- CTF challenge
modified_time: '2017-11-26T16:19:28.069-08:00'
blogger_id: tag:blogger.com,1999:blog-4206503528938574504.post-5540717917140067769
blogger_orig_url: https://k3ramas.blogspot.com/2017/11/tuctf-2017-vm-challenges.html
---

<b>Challenge:</b><br />Gateway<br /><b>Category:</b><br />VM<br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/gateway_challenge.png?raw=true" /><br /><br />This CTF provided a VM which encompassed a number of different challenges, the first part of which is<br />to actually access it. When booting up the VM, we find that the drive it's accessing is<br />encrypted and you need a passkey to decrypt it. Luckily there is an unencrypted drive that is<br />accessible.<br /><br />To access this, we need to add a live CD to the VM so that we can boot off that instead.<br />I chose to use Kali Linux for this. Once we boot into Kali, we can access the unencrypted<br />drive which is labeled "Boot".<br /><br />Right away there is a file that stands out: "usefultool.exe"<br />Running this we discover that it is just a program that ROT13's whatever string you provide, so<br />this is a pretty good indicator that our flag will be a ROT13 that needs to be decoded.<br /><br />Looking around the drive more, nothing of use was really found, so I took a closer look at the<br />.exe. Running strings on it I found something interesting.<br /><br />However, this turned out to only be part of the flag. Looking closer at the strings output,<br />it seems that the exe has been packed with UPX. Using UPX to unpack it, we can finally get the full<br />output of all the strings, as well as our full ROT13 flag.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/gateway_packed.png?raw=true" /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/gateway_fullflagrot13.png?raw=true" /><br /><br />Decoding it we get our flag as well as the password to unencrypt the drive.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/gateway_flagdecoded.png?raw=true" /><br /><br /><br /><b>Challenge:</b><br />Leap of Faith<br /><b>Category:</b><br />VM<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/leapoffaith_challenge.png?raw=true" /><br /><br />This challenge utilized the same exe from the previous challenge. I overthought this one a lot, but looking at all the strings in GDB by accessing the function 'randomPaddingFunction' that I was told to ignore, I finally realized that the first letter of each string gave the flag!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/leapoffaith_flag.png?raw=true" /><br /><br /><br /><b>Challenge:</b><br />Worth a Thousand Words<br /><b>Category:</b><br />VM<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/worthathousandword_challenge.png?raw=true" /><br /><br />In the photos folder on the VM there are three different jpgs. Each one contains a part of the flag.<br />Using strings on 1.jpg we get the first part which is just TUCTF{.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/1000words_1jpg.png?raw=true" /><br /><br />2.jpg has a hidden file inside of it and we can extract it with binwalk. Dumping the contents we get our second part of the flag: Devils<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/1000words_part2.png?raw=true" /><br /><br />3.jpg is corrupted and needs to be fixed before we can open it. This took a bit of research, but once I found which portions of the IHDR were wrong, I was able to edit it in hexeditor and make it so we can see the image. Running pngcheck helped confirm when it was actually uncorrupted.<br /><br />Broke:<br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/100wordshexedit.png?raw=true" /><br /><br />Edited:<br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/1000words_hexedited3.png?raw=true" /><br /><br />Opening the image, there is a barcode on the screen in the picture, and scanning this gives us the final part of the flag: InThePixels}<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/1000words_uncorrupt.png?raw=true" /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/1000words_barcode.png?raw=true" /><br /><br /><b>Challenge:</b><br />Euchlid Go Away<br /><b>Category:</b><br />VM<br /><br />This was one of my favorite challenges of the CTF. Remoting in with netcat, we are dropped into a text-based game. There is a lot of messaging about a rumored hidden room, so I guessed this is exactly what needed to be found.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/euclid_start.png?raw=true" /><br /><br />There were a couple tricks to this: first, we need to be admin, which I guessed would give us some extra powers. Messaging an admin in the game reveals their username, so I took that and logged back in under that admin name.<br /><br />Next, I sent a message that I had bugged leveling and increased my level past the normal user cap of 255 and make myself 256.<br />Upon doing so we are identified as admin and we have some newfound powers!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/euclid_escalate.png?raw=true" /><br /><br />One of which is the ability to teleport and a map of all the rooms.<br /><br />Teleporting to the admin room first, there was a function to leave messages for the devs. I immediately thought to input "cat flag.txt". After this, I teleported to the dev room and it gave me the option to read the message I left for myself. This executed the action I left in the message, and I got the flag!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/euclid_flagget!.png?raw=true" /><br /><br />