---
layout: post
title: TUCTF 2017 | Rev and Pwn Challenges
date: '2017-11-26T16:23:00.002-08:00'
author: Keramas
tags:
- CTF challenge
modified_time: '2017-11-26T16:23:14.131-08:00'
blogger_id: tag:blogger.com,1999:blog-4206503528938574504.post-4167208798128350467
blogger_orig_url: https://k3ramas.blogspot.com/2017/11/tuctf-2017-rev-and-pwn-challenges.html
---

<b>Challenge:</b><br />Funmail<br /><b>Category:</b><br />Rev<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/funmail_challenge.png?raw=true" /><br /><br />Running the binary, we are prompted for a username and password. We already know the username, so we need to find out the password. This is easy enough because it is hard coded and can be discovered by running strings on the program.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/tuctf_funmail.png?raw=true" /><br /><br />Now we log in with our credentials and read the email, which gives us our flag!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/tuctf_funmail2.png?raw=true" /><br /><br /><br /><b>Challenge:</b><br />Funmail 2.0<br /><b>Category:</b><br />Rev<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/funmail2_challenge.png?raw=true" /><br /><br />For this challenge, we get another hard coded password, but the program doesn't work properly and terminates. What to do?<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/funmail2.png?raw=true" /><br /><br />Well, we can grab the address for a function called printFlag, and then use GDB to set a breakpoint in main and set the EIP to the address of printFlag. Continuing to run the program gives us our flag.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/funmail2_flag.png?raw=true" /><br /><br /><br /><br /><br /><br /><b>Challenge:</b><br />Vuln Chat<br /><b>Category:</b><br />Pwn<br /><br />At first I thought this appeared to be a pretty simple buffer overflow problem, but it was a bit more interesting than that!<br />Running the program we get prompted for a name and then Djinn enters and asks for proof before he spills the beans with his hot info.<br /><br />Exploring with objdump a bit, there is a hidden function 'printFlag', so this is going to be our target address to use to overwrite EIP at some point.<br /><br />Attempting to input a bunch of A's only went so far and I wasn't able to overwrite EIP. Scanf was limiting my overwrite.<br /><br />Setting some breakpoints at the printf calls, I took a look at the stack and noticed that the scanf buffer was actually on the stack, and it was possible to overwrite far enough to modify this.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/vulnchat_scanfbuffer.png?raw=true" /><br /><br />I was able to change the scanf buffer to something bigger (I set it to 64 bytes), and then I was finally able to write far enough to overflow and get a segfault.<br /><br />Using some trial and error to get the proper offset to land the printFlag address, I found that an offset of 54 bytes was the ripe spot.<br /><br />I wrote up the following exploit in python to be deployed to the server.<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/vulnchat_exploitcode.png?raw=true" /><br /><br />Executing this we get our flag!<br /><br /><img src="https://github.com/Keramas/CTF-Writeups/blob/master/Images/TUCTF2017/vulnchat_flag.png?raw=true" /><br /><br />