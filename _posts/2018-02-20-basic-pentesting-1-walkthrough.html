---
layout: post
title: 'Basic Pentesting: 1 Walkthrough'
date: '2018-02-20T22:18:00.000-08:00'
author: Keramas
tags:
- VM walkthrough
modified_time: '2018-02-20T22:18:29.150-08:00'
thumbnail: https://4.bp.blogspot.com/-6dwrsuam1K0/Wo0Jkyyr8KI/AAAAAAAAAdA/qhf81gAg0tks0FR4MsMgU42OgEQR1vGcQCEwYBhgL/s72-c/nmap.png
blogger_id: tag:blogger.com,1999:blog-4206503528938574504.post-4635069909988103448
blogger_orig_url: https://k3ramas.blogspot.com/2018/02/basic-pentesting-1-walkthrough.html
---

<br />It's been quite a while since doing a VM (been busy moving, new job, etc...), and I saw that a bunch of new ones had been uploaded to Vulnhub, so I finally got a chance to sit down and have some fun.<br /><br />Basic Pentesting: 1 was fun. Definitely geared towards beginners, but it made for an enjoyable night!<br /><br />Naturally, start with an arp-scan to determine the machine's IP, and then use nmap to determine what services and ports are up.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-6dwrsuam1K0/Wo0Jkyyr8KI/AAAAAAAAAdA/qhf81gAg0tks0FR4MsMgU42OgEQR1vGcQCEwYBhgL/s1600/nmap.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="290" data-original-width="607" height="190" src="https://4.bp.blogspot.com/-6dwrsuam1K0/Wo0Jkyyr8KI/AAAAAAAAAdA/qhf81gAg0tks0FR4MsMgU42OgEQR1vGcQCEwYBhgL/s400/nmap.png" width="400" /></a></div><br />Following up on this, running Sparta will help see if there is anything interesting as well.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-CYskKIiORcs/Wo0JnaD1zvI/AAAAAAAAAdA/I7EP8yKJCnMttWrHr8tXiB8PxlzGn8NEwCEwYBhgL/s1600/sparta.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="540" data-original-width="1172" height="292" src="https://4.bp.blogspot.com/-CYskKIiORcs/Wo0JnaD1zvI/AAAAAAAAAdA/I7EP8yKJCnMttWrHr8tXiB8PxlzGn8NEwCEwYBhgL/s640/sparta.png" width="640" /></a></div><br />Nikto discovers an interesting file on the HTTP server, so let's head over and find out what is there...<br />(Note: you will need to add the domain to your /etc/hosts file to properly browse.)<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-j4lhVWtAvm8/Wo0Jl2fO00I/AAAAAAAAAc0/keBqmK0HvI8ubR_ieLnn1efzW8Q-k6FVQCEwYBhgL/s1600/port80.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="430" data-original-width="1198" height="114" src="https://1.bp.blogspot.com/-j4lhVWtAvm8/Wo0Jl2fO00I/AAAAAAAAAc0/keBqmK0HvI8ubR_ieLnn1efzW8Q-k6FVQCEwYBhgL/s320/port80.png" width="320" /></a></div><br />Mmmm a WordPress blog. Surely this use locked it down real tight and it's perfectly up to date!<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-mABUxiQNS7o/Wo0Jn7bnqsI/AAAAAAAAAdE/XjT0RkYZnPQ7PLAg8Pt6HuT5cn2iGYKEQCEwYBhgL/s1600/wplogin.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="572" data-original-width="462" height="320" src="https://1.bp.blogspot.com/-mABUxiQNS7o/Wo0Jn7bnqsI/AAAAAAAAAdE/XjT0RkYZnPQ7PLAg8Pt6HuT5cn2iGYKEQCEwYBhgL/s320/wplogin.png" width="258" /></a></div><br />admin:admin... How secure! Arriving at the admin portal we have free reign to do whatever we please with the plugins and site. So, I got my handy PHP reverse shell code and dropped it into the Akismet plugin replacing the code that was there, and then activating the plugin.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/--JBIdARQHb8/Wo0JlYKBXNI/AAAAAAAAAdA/Elp4YGwz47kknUnB5i2cb-csvO8ZRfXXgCEwYBhgL/s1600/phpbackdoor_loaded.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="750" data-original-width="1180" height="404" src="https://4.bp.blogspot.com/--JBIdARQHb8/Wo0JlYKBXNI/AAAAAAAAAdA/Elp4YGwz47kknUnB5i2cb-csvO8ZRfXXgCEwYBhgL/s640/phpbackdoor_loaded.png" width="640" /></a></div><br /><br />&nbsp;Before hitting "Update File" have your listening port active. After pressing the button, we get onto the box with the www-data user.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-7oUzC7lkQvI/Wo0JmeiJYqI/AAAAAAAAAc4/SJfAW8EseSIGwDcEBmR7432HUEB6eMjhwCEwYBhgL/s1600/revshellopen.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="204" data-original-width="849" height="152" src="https://3.bp.blogspot.com/-7oUzC7lkQvI/Wo0JmeiJYqI/AAAAAAAAAc4/SJfAW8EseSIGwDcEBmR7432HUEB6eMjhwCEwYBhgL/s640/revshellopen.png" width="640" /></a></div><br />Now it's time to enumerate for privilege escalation. I first headed to the wp-config.php file out of habit since creds are always laying around in there based off past VM experience, and sure enough we got a root creds for the mysql database.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/--EnEoQ_EAEY/Wo0JkAwJvBI/AAAAAAAAAdE/PDSs2xX8V1oIykWLYoNSASB4THgw6YZ0wCEwYBhgL/s1600/db_creds.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="613" data-original-width="849" height="460" src="https://1.bp.blogspot.com/--EnEoQ_EAEY/Wo0JkAwJvBI/AAAAAAAAAdE/PDSs2xX8V1oIykWLYoNSASB4THgw6YZ0wCEwYBhgL/s640/db_creds.png" width="640" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-TjxZt1SNWz0/Wo0JkIk2IgI/AAAAAAAAAc0/QG7baDAAZUIS09SMH9wCfiSfzfaETBMCQCEwYBhgL/s1600/mysqlroot.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="322" data-original-width="712" height="288" src="https://1.bp.blogspot.com/-TjxZt1SNWz0/Wo0JkIk2IgI/AAAAAAAAAc0/QG7baDAAZUIS09SMH9wCfiSfzfaETBMCQCEwYBhgL/s640/mysqlroot.png" width="640" /></a></div><br /><br />Logging into mysql with these creds didn't yield much at all. I attempted to get root from a sys.exec call, but it wasn't on the box. After a bit of exploring a looked around for some other files of interest on the box.<br /><br />Searching high and low I almost missed the critical issue with this box...<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-jTSTx952-zo/Wo0JkNS9uhI/AAAAAAAAAc4/tFQEApY_DDgNxCq0e-qywH8kLtylr-uYACEwYBhgL/s1600/etcpasswd.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="159" data-original-width="521" height="194" src="https://3.bp.blogspot.com/-jTSTx952-zo/Wo0JkNS9uhI/AAAAAAAAAc4/tFQEApY_DDgNxCq0e-qywH8kLtylr-uYACEwYBhgL/s640/etcpasswd.png" width="640" /></a></div><br />A beautiful invitation to change the passwd file! Don't mind if i do! First we just need to make a hash of whatever password we want. I chose 'derp'.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-eBE7-A0P_7o/Wo0JkjV1tBI/AAAAAAAAAc8/HaS7WgSN9R0LSDfdzvzWbXAlme5FnhYnwCEwYBhgL/s1600/newpw.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="115" data-original-width="332" height="110" src="https://1.bp.blogspot.com/-eBE7-A0P_7o/Wo0JkjV1tBI/AAAAAAAAAc8/HaS7WgSN9R0LSDfdzvzWbXAlme5FnhYnwCEwYBhgL/s320/newpw.png" width="320" /></a></div><br /><br />Since vim and nano were not on the box, I just paired this with the root info from /etc/passwd and echoed it into the file.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-Chn_Q9_8R9M/Wo0Jm5_mDkI/AAAAAAAAAc8/viroG5K4aREcjhUMv_OD_qk7DbEQNUOKQCEwYBhgL/s1600/root.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="405" data-original-width="937" height="276" src="https://3.bp.blogspot.com/-Chn_Q9_8R9M/Wo0Jm5_mDkI/AAAAAAAAAc8/viroG5K4aREcjhUMv_OD_qk7DbEQNUOKQCEwYBhgL/s640/root.png" width="640" /></a></div><br /><br />Yep... I used the double arrows because I was lazy but then the machine forgot who I was :(<br />No issues--I just copied the www-data line and echoed that back in. Now that our password is set, we just call root, and the machine happily escalates us!<br /><br /><br /><br /><br />